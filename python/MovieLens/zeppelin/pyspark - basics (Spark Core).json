{"paragraphs":[{"text":"%pyspark\n\nrdd = sc.parallelize(range(1,1000001), 4)","user":"anonymous","dateUpdated":"2020-03-20T09:59:27+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1583959310612_131819139","id":"20200225-171106_1322002680","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-20T09:59:27+0000","dateFinished":"2020-03-20T09:59:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:342"},{"text":"%md\n\n# Actions\n","user":"anonymous","dateUpdated":"2020-03-20T09:52:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Actions</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1583959310624_-971025729","id":"20200225-175349_1770751575","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-20T09:52:11+0000","dateFinished":"2020-03-20T09:52:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"text":"%pyspark\n\n# собрать все содержимое rdd на driver-ноде\nprint(rdd.collect())\n\n# получить первый элемент\nprint(rdd.first())\n\n# получить первых n элементов\nprint(rdd.take(5))\n\n# узнать число партиций в RDD\nprint(rdd.getNumPartitions())\n\n# получить основные метрики набора \nrdd.stats()","user":"anonymous","dateUpdated":"2020-03-20T09:52:58+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n1\n[1, 2, 3, 4, 5]\n4\n(count: 10, mean: 5.5, stdev: 2.8722813232690143, max: 10.0, min: 1.0)"}]},"apps":[],"jobName":"paragraph_1583959310624_-393319426","id":"20200225-171339_1825454823","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-20T09:52:58+0000","dateFinished":"2020-03-20T09:53:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:344"},{"text":"%pyspark\n\n# rdd.glom() - новый rdd, элементами которого являются партиции предыдущего rdd\nprint(rdd.glom().collect())\n\nrdd2 = rdd.glom()\n\n# число элементов в rdd2 = числу партиций в rdd\nprint(rdd2.count())\n","user":"anonymous","dateUpdated":"2020-03-20T09:54:05+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":159.28,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[1, 2], [3, 4, 5], [6, 7], [8, 9, 10]]\n4\n"}]},"apps":[],"jobName":"paragraph_1583959310628_-1799394452","id":"20200225-171338_1980760280","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-20T09:54:05+0000","dateFinished":"2020-03-20T09:54:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"text":"%pyspark\n\n# сохраняем в указанную hdfs директорию\nrdd.saveAsTextFile(\"/user/timofey/rdd\")\n","user":"anonymous","dateUpdated":"2020-03-20T10:01:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1583959310628_623374439","id":"20200225-190923_203818578","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-20T10:01:31+0000","dateFinished":"2020-03-20T10:01:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:346"},{"text":"%sh\n\nhdfs dfs -ls /user/timofey/rdd","user":"anonymous","dateUpdated":"2020-03-20T10:02:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 5 items\n-rw-r--r--   2 zeppelin hadoop          0 2020-03-20 10:01 /user/timofey/rdd/_SUCCESS\n-rw-r--r--   2 zeppelin hadoop    1638895 2020-03-20 10:01 /user/timofey/rdd/part-00000\n-rw-r--r--   2 zeppelin hadoop    1750000 2020-03-20 10:01 /user/timofey/rdd/part-00001\n-rw-r--r--   2 zeppelin hadoop    1750000 2020-03-20 10:01 /user/timofey/rdd/part-00002\n-rw-r--r--   2 zeppelin hadoop    1750001 2020-03-20 10:01 /user/timofey/rdd/part-00003\n"}]},"apps":[],"jobName":"paragraph_1583959487900_1089570378","id":"20200311-204447_1200851981","dateCreated":"2020-03-11T20:44:47+0000","dateStarted":"2020-03-20T10:02:56+0000","dateFinished":"2020-03-20T10:02:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"%sh\n\nhdfs dfs -cat /user/timofey/rdd/*2 | head","user":"anonymous","dateUpdated":"2020-03-20T10:07:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"500001\n500002\n500003\n500004\n500005\n500006\n500007\n500008\n500009\n500010\ncat: Unable to write to output stream.\n"}]},"apps":[],"jobName":"paragraph_1584698704930_372962992","id":"20200320-100504_121960056","dateCreated":"2020-03-20T10:05:04+0000","dateStarted":"2020-03-20T10:07:38+0000","dateFinished":"2020-03-20T10:07:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:348"},{"text":"%sh\n\nhdfs dfs -rm -f -r /user/timofey/rdd\n\n","user":"anonymous","dateUpdated":"2020-03-20T10:00:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/timofey/rdd\n"}]},"apps":[],"jobName":"paragraph_1583959310628_-1277049528","id":"20200225-171338_355648286","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-20T10:00:02+0000","dateFinished":"2020-03-20T10:00:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:349"},{"text":"%md\n# Transformations\n","user":"anonymous","dateUpdated":"2020-03-11T20:41:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310628_1829182715","id":"20200225-195616_1707692883","dateCreated":"2020-03-11T20:41:50+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:350"},{"text":"%pyspark\n\n# только четные элементы\nrdd3 = rdd.filter(lambda x: x%2 == 0)\n\n# квадраты элементов\nrdd4 = rdd.map(lambda x: x**2)\n\n# подсчет числа четных и нечетных элементов\nrdd5 = rdd.map(lambda x: ('even' if x%2 == 0 else u'odd', 1)).reduceByKey( lambda x, y: x + y)","user":"anonymous","dateUpdated":"2020-03-19T11:04:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310628_1440081325","id":"20200225-171337_394506167","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-19T11:04:30+0000","dateFinished":"2020-03-19T11:04:30+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:351"},{"text":"%pyspark\n\nrdd5.collect()\n","user":"anonymous","dateUpdated":"2020-03-19T11:04:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310629_1084590051","id":"20200225-202946_529121751","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-19T11:04:35+0000","dateFinished":"2020-03-19T11:04:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:352"},{"text":"%pyspark\n\n# случайная выборка без повторений с вероятностью включения каждого элемента 0.5\nprint(rdd.sample(False, 0.5).collect())","user":"anonymous","dateUpdated":"2020-03-11T22:06:11+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310629_-481113345","id":"20200225-200332_1301377261","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-11T22:06:11+0000","dateFinished":"2020-03-11T22:06:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"%pyspark\n\nrdd = sc.textFile(\"/user/timofey/input.txt\")","user":"anonymous","dateUpdated":"2020-03-19T11:18:32+0000","config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310629_-1790280143","id":"20200225-171336_82217094","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-19T11:18:32+0000","dateFinished":"2020-03-19T11:18:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:354"},{"text":"%pyspark\n\nrdd.collect()","user":"anonymous","dateUpdated":"2020-03-19T15:29:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1584616090829_1293854299","id":"20200319-110810_254027685","dateCreated":"2020-03-19T11:08:10+0000","dateStarted":"2020-03-19T11:18:37+0000","dateFinished":"2020-03-19T11:18:37+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:355"},{"text":"%pyspark\n\nrdd.flatMap(lambda _:_.split()).collect()","user":"anonymous","dateUpdated":"2020-03-19T11:14:20+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310629_-640686512","id":"20200225-171336_41903507","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-19T11:14:21+0000","dateFinished":"2020-03-19T11:14:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:356"},{"text":"%pyspark\n\n# изменение числа партиций. Обратите внимание на неравномерность партиций\nrdd2 = rdd.repartition(3)\nrdd2.glom().map(lambda x: len(x)).collect()","user":"anonymous","dateUpdated":"2020-03-19T11:15:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310629_-1359338987","id":"20200226-112338_75837934","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-19T11:15:18+0000","dateFinished":"2020-03-19T11:15:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:357"},{"text":"%pyspark\n\nrdd_a = sc.parallelize([1,2,3,4])\nrdd_b = sc.parallelize([3,4,5,6])\n\n# пересечение двух наборов данных\nprint(rdd_a.intersection(rdd_b).collect())\n\n# разность\nprint(rdd_a.subtract(rdd_b).collect())\n\n# декартово произведение\nprint(rdd_a.cartesian(rdd_b).collect())\n\n# объединение \nprint(rdd_a.union(rdd_b).collect())","user":"anonymous","dateUpdated":"2020-03-11T22:06:42+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310630_2086310505","id":"20200225-171336_1748989109","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-11T22:06:42+0000","dateFinished":"2020-03-11T22:06:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"%md\n# WordCount","user":"anonymous","dateUpdated":"2020-03-25T09:54:26+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.RuntimeException: OpenJDK 64-Bit Server VM warning: ignoring option MaxPermSize=512m; support was removed in 8.0\nOpenJDK 64-Bit Server VM warning: INFO: os::commit_memory(0x00000000c0000000, 716177408, 0) failed; error='Cannot allocate memory' (errno=12)\n#\n# There is insufficient memory for the Java Runtime Environment to continue.\n# Native memory allocation (mmap) failed to map 716177408 bytes for committing reserved memory.\n# An error report file with more information is saved as:\n# /var/lib/zeppelin/hs_err_pid10727.log\n\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterManagedProcess.start(RemoteInterpreterManagedProcess.java:205)\n\tat org.apache.zeppelin.interpreter.ManagedInterpreterGroup.getOrCreateInterpreterProcess(ManagedInterpreterGroup.java:64)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getOrCreateInterpreterProcess(RemoteInterpreter.java:111)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.internal_create(RemoteInterpreter.java:164)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.open(RemoteInterpreter.java:132)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:299)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:407)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:315)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"}]},"apps":[],"jobName":"paragraph_1583959310630_1960578048","id":"20200225-171331_1630553976","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-25T09:54:27+0000","dateFinished":"2020-03-25T09:55:27+0000","status":"ERROR","errorMessage":"java.lang.RuntimeException: OpenJDK 64-Bit Server VM warning: ignoring option MaxPermSize=512m; support was removed in 8.0\nOpenJDK 64-Bit Server VM warning: INFO: os::commit_memory(0x00000000c0000000, 716177408, 0) failed; error='Cannot allocate memory' (errno=12)\n#\n# There is insufficient memory for the Java Runtime Environment to continue.\n# Native memory allocation (mmap) failed to map 716177408 bytes for committing reserved memory.\n# An error report file with more information is saved as:\n# /var/lib/zeppelin/hs_err_pid10727.log\n\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterManagedProcess.start(RemoteInterpreterManagedProcess.java:205)\n\tat org.apache.zeppelin.interpreter.ManagedInterpreterGroup.getOrCreateInterpreterProcess(ManagedInterpreterGroup.java:64)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getOrCreateInterpreterProcess(RemoteInterpreter.java:111)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.internal_create(RemoteInterpreter.java:164)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.open(RemoteInterpreter.java:132)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:299)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:407)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:315)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"%sh\n\n# Удалим старые результаты если они есть. предположительно папка /user/timofey уже создана в HDFS\n\nhdfs dfs -rm -f -r /user/timofey/output\n","user":"anonymous","dateUpdated":"2020-03-16T21:11:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310630_-1507642017","id":"20200226-113412_1394940983","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-16T21:11:00+0000","dateFinished":"2020-03-16T21:11:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"%pyspark\n\n# подсчет числа слов с выводом на экран\nimport re\n\nWORD_RE = re.compile(r\"[\\w']+\")\n\ninput_rdd = sc.textFile(\"/user/timofey/input.txt\")\n\ncounts_rdd = input_rdd.flatMap(lambda line: [w.lower() for w in WORD_RE.findall(line)]) \\\n                .map(lambda word: (word, 1)) \\\n                .reduceByKey(lambda x, y: x + y)\n    \n\ncounts_rdd.collect()\n","user":"anonymous","dateUpdated":"2020-03-16T21:06:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310630_554280813","id":"20200226-112643_347771848","dateCreated":"2020-03-11T20:41:50+0000","dateStarted":"2020-03-16T21:06:30+0000","dateFinished":"2020-03-16T21:06:30+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:361"},{"text":"%pyspark\n\ncounts_rdd.saveAsTextFile(\"/user/timofey/output\")\n","user":"anonymous","dateUpdated":"2020-03-11T20:41:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310630_-1675563005","id":"20200226-121023_705153051","dateCreated":"2020-03-11T20:41:50+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"%sh\n\n# проверяем наличие результатов, количество part-файлов определяет число тасков, выполнявших reduceByKey\n\nhdfs dfs -ls /user/timofey/output/*\n","user":"anonymous","dateUpdated":"2020-03-11T20:41:50+0000","config":{"colWidth":6,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310631_24699490","id":"20200226-122644_1120936706","dateCreated":"2020-03-11T20:41:50+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"text":"%sh\n\n# смотрим содержимое файлов-результатов\n\nhdfs dfs -cat /user/timofey/output/*\n","user":"anonymous","dateUpdated":"2020-03-11T20:41:50+0000","config":{"colWidth":6,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310631_1869811453","id":"20200226-133124_1296270928","dateCreated":"2020-03-11T20:41:50+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:364"},{"text":"%pyspark\n\n# более наглядный формат отображения в ноутбуках Zeppelin\n\nprint(\"%table word\\tcount\")\nfor word, count in counts_rdd.collect():\n    print(\"{}\\t{}\".format(word, count))","user":"anonymous","dateUpdated":"2020-03-11T20:41:57+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":424,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false},"stackedAreaChart":{"style":"stack"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"word":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"word","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310639_1345144707","id":"20200226-133147_1413822035","dateCreated":"2020-03-11T20:41:50+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:365"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-03-11T20:41:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1583959310639_-858727114","id":"20200226-133546_759521013","dateCreated":"2020-03-11T20:41:50+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:366"}],"name":"pyspark - basics (Spark Core)","id":"2F5X4D97A","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}